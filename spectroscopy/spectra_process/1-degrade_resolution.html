<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>é™ä½åˆ†è¾¨ç‡ | å¤©æ–‡ wiki çŸ¥è¯†åº“</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="shortcut icon" href="/Astro/favicon.ico">
    <meta name="description" content="å­¦ä¹ ç¬”è®°">
    
    <link rel="preload" href="/Astro/assets/css/0.styles.8594a18f.css" as="style"><link rel="preload" href="/Astro/assets/js/app.2824fc65.js" as="script"><link rel="preload" href="/Astro/assets/js/2.a0d0d233.js" as="script"><link rel="preload" href="/Astro/assets/js/3.90804e27.js" as="script"><link rel="prefetch" href="/Astro/assets/js/10.0d665c34.js"><link rel="prefetch" href="/Astro/assets/js/11.1f5b658e.js"><link rel="prefetch" href="/Astro/assets/js/12.c11a373a.js"><link rel="prefetch" href="/Astro/assets/js/13.cc284190.js"><link rel="prefetch" href="/Astro/assets/js/4.8b83f7d2.js"><link rel="prefetch" href="/Astro/assets/js/5.c07d27fc.js"><link rel="prefetch" href="/Astro/assets/js/6.ac50a42e.js"><link rel="prefetch" href="/Astro/assets/js/7.0b13d5d3.js"><link rel="prefetch" href="/Astro/assets/js/8.96155048.js"><link rel="prefetch" href="/Astro/assets/js/9.a7b0346d.js">
    <link rel="stylesheet" href="/Astro/assets/css/0.styles.8594a18f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Astro/" class="home-link router-link-active"><!----> <span class="site-name">å¤©æ–‡ wiki çŸ¥è¯†åº“</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Astro/" class="nav-link">
  é¦–é¡µ
</a></div><div class="nav-item"><a href="/Astro/intro/" class="nav-link">
  ä»‹ç»
</a></div><div class="nav-item"><a href="/Astro/learn/" class="nav-link">
  å­¦ä¹ è·¯çº¿
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="å…‰è°±å­¦" class="dropdown-title"><span class="title">å…‰è°±å­¦</span> <span class="arrow down"></span></button> <button type="button" aria-label="å…‰è°±å­¦" class="mobile-dropdown-title"><span class="title">å…‰è°±å­¦</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Astro/spectroscopy/concepts/" class="nav-link">
  å¸¸è§æ¦‚å¿µ
</a></li><li class="dropdown-item"><!----> <a href="/Astro/spectroscopy/spectra_process/" class="nav-link router-link-active">
  å…‰è°±å¤„ç†
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/iScottMark/Astro" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Astro/" class="nav-link">
  é¦–é¡µ
</a></div><div class="nav-item"><a href="/Astro/intro/" class="nav-link">
  ä»‹ç»
</a></div><div class="nav-item"><a href="/Astro/learn/" class="nav-link">
  å­¦ä¹ è·¯çº¿
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="å…‰è°±å­¦" class="dropdown-title"><span class="title">å…‰è°±å­¦</span> <span class="arrow down"></span></button> <button type="button" aria-label="å…‰è°±å­¦" class="mobile-dropdown-title"><span class="title">å…‰è°±å­¦</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Astro/spectroscopy/concepts/" class="nav-link">
  å¸¸è§æ¦‚å¿µ
</a></li><li class="dropdown-item"><!----> <a href="/Astro/spectroscopy/spectra_process/" class="nav-link router-link-active">
  å…‰è°±å¤„ç†
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/iScottMark/Astro" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/Astro/spectroscopy/spectra_process/" aria-current="page" class="sidebar-link">å…‰è°±å¤„ç†</a></li><li><a href="/Astro/spectroscopy/spectra_process/1-degrade_resolution.html" aria-current="page" class="active sidebar-link">é™ä½åˆ†è¾¨ç‡</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Astro/spectroscopy/spectra_process/1-degrade_resolution.html#ç®€ä»‹" class="sidebar-link">ç®€ä»‹</a></li><li class="sidebar-sub-header"><a href="/Astro/spectroscopy/spectra_process/1-degrade_resolution.html#æ–¹æ³•" class="sidebar-link">æ–¹æ³•</a></li><li class="sidebar-sub-header"><a href="/Astro/spectroscopy/spectra_process/1-degrade_resolution.html#æœ€ä½³å®è·µ" class="sidebar-link">æœ€ä½³å®è·µ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Astro/spectroscopy/spectra_process/1-degrade_resolution.html#_1-åŸºæœ¬æ“ä½œ" class="sidebar-link">â‘  åŸºæœ¬æ“ä½œ</a></li><li class="sidebar-sub-header"><a href="/Astro/spectroscopy/spectra_process/1-degrade_resolution.html#_2-å¤„ç†-pollux-æ¨¡å‹å…‰è°±" class="sidebar-link">â‘¡ å¤„ç† POLLUX æ¨¡å‹å…‰è°±</a></li><li class="sidebar-sub-header"><a href="/Astro/spectroscopy/spectra_process/1-degrade_resolution.html#_3-é™è‡³-lamost-å…‰è°±çš„ä½åˆ†è¾¨ç‡" class="sidebar-link">â‘¢ é™è‡³ LAMOST å…‰è°±çš„ä½åˆ†è¾¨ç‡</a></li><li class="sidebar-sub-header"><a href="/Astro/spectroscopy/spectra_process/1-degrade_resolution.html#_4-é™ä½ä¸ç­‰é—´éš”æ³¢é•¿æ­¥é•¿çš„å…‰è°±åˆ†è¾¨ç‡" class="sidebar-link">â‘£ é™ä½ä¸ç­‰é—´éš”æ³¢é•¿æ­¥é•¿çš„å…‰è°±åˆ†è¾¨ç‡</a></li></ul></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="é™ä½åˆ†è¾¨ç‡"><a href="#é™ä½åˆ†è¾¨ç‡" class="header-anchor">#</a> é™ä½åˆ†è¾¨ç‡</h1> <h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="header-anchor">#</a> ç®€ä»‹</h2> <p>ã€é™ä½åˆ†è¾¨ç‡ã€å¤šç”¨äºä¸åŒåˆ†è¾¨ç‡å…‰è°±çš„æ¯”è¾ƒä¸Šï¼Œä¸»è¦æ˜¯å°†è¾ƒé«˜çš„åˆ†è¾¨ç‡å…‰è°±ï¼ˆå¦‚ç†è®ºåˆæˆå…‰è°±ï¼‰é™ä½è‡³è¾ƒä½çš„è§‚æµ‹å…‰è°±åˆ†è¾¨ç‡ï¼ˆå¦‚ SDSS, LAMOSTï¼‰ã€‚</p> <p>é™ä½åˆ†è¾¨ç‡åœ¨æ–‡ç« çš„æ•°æ®å¤„ç†éƒ¨åˆ†ä¸­å¤šè¢«æè¿°ä¸º &quot;degrade the spectral resolution&quot; æˆ–è€… &quot;convolve the spectra using Gaussian Kernel&quot;ã€‚</p> <h2 id="æ–¹æ³•"><a href="#æ–¹æ³•" class="header-anchor">#</a> æ–¹æ³•</h2> <p>è¯¥æ­¥éª¤å®é™…ä¸Šå°±æ˜¯ç”¨ä¸€ä¸ªä¸€ç»´é«˜æ–¯æ»¤æ³¢å™¨å¯¹ä¸€ç»´å…‰è°±è¿›è¡Œå·ç§¯æ“ä½œï¼Œèµ·åˆ°æ¨¡ç³Šå¹³æ»‘çš„ä½œç”¨ã€‚</p> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>ç¬”è€…åœ¨æœ€åˆæ“ä½œä¸­ï¼Œå°†ã€é™ä½åˆ†è¾¨ç‡ã€ä¸ã€ä¸‹é‡‡æ ·ã€çš„æ¦‚å¿µæ··æ·†ã€‚åœ¨ä¸å¯¼å¸ˆçš„æ²Ÿé€šäº¤æµä¸­ï¼Œä¹Ÿäº†è§£åˆ°æœ‰å­¦ç”Ÿåœ¨è®ºæ–‡ä¸­çŠ¯è¿‡åŒæ ·çš„é”™è¯¯ã€‚</p></div> <p>ã€ä¸‹é‡‡æ ·ã€æ˜¯å¯¹ä¸€ä¸ªåºåˆ—é—´éš”å‡ ä¸ªæ ·å€¼é‡‡æ ·ä¸€æ¬¡ï¼Œe.g. <code>[1, 1, 2, 2, 3, 3]</code> å¦‚æœé—´éš” step = 2 è¿›è¡Œé‡‡æ ·ï¼Œåˆ™æ–°åºåˆ—ä¸º <code>[1, 2, 3]</code>ã€‚</p> <h2 id="æœ€ä½³å®è·µ"><a href="#æœ€ä½³å®è·µ" class="header-anchor">#</a> æœ€ä½³å®è·µ</h2> <p>åœ¨å®é™…çš„å…‰è°±å¤„ç†ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ã€å…·ä½“é—®é¢˜å…·ä½“åˆ†æã€ï¼Œé’ˆå¯¹ä¸åŒçš„å…‰è°±ä»ªå™¨ç‰¹å¾ï¼Œæˆ–æ˜¯ç§‘å­¦ç›®çš„ã€å®éªŒç²¾åº¦ç­‰ï¼Œå¯¹å…‰è°±è¿›è¡Œç‰¹å®šçš„é™ä½åˆ†è¾¨ç‡æ“ä½œã€‚</p> <p>ä¸‹é¢ä»¥ 4 ä¸ªä¾‹å­è¿›è¡Œè®²è§£ï¼Œå®éªŒä»£ç å‡åœ¨ Python 3 ä¸‹è¿è¡Œã€‚</p> <p><strong>ç¬”è€…å¯¹ç¬¬ â‘¢ ä¸ª LAMOST çš„ä¾‹å­è¿›è¡Œäº†è¯¦ç»†çš„ä»£ç æ³¨è§£ã€‚</strong></p> <h3 id="_1-åŸºæœ¬æ“ä½œ"><a href="#_1-åŸºæœ¬æ“ä½œ" class="header-anchor">#</a> â‘  åŸºæœ¬æ“ä½œ</h3> <blockquote><p>è¯¦æƒ…è¯·å‚è€ƒ <a href="https://lotharschanne.wordpress.com/convolution-of-1d-spectra-with-gaussian-functions/" target="_blank" rel="noopener noreferrer">Convolution of 1d-spectra with Gaussian functions<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">from</span> astropy<span class="token punctuation">.</span>convolution <span class="token keyword">import</span> Gaussian1DKernel
<span class="token keyword">from</span> astropy<span class="token punctuation">.</span>convolution <span class="token keyword">import</span> convolve
<span class="token keyword">from</span> astropy<span class="token punctuation">.</span>io <span class="token keyword">import</span> <span class="token builtin">ascii</span>

spectrum_name <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">'Path and name of the file: '</span><span class="token punctuation">)</span>

std <span class="token operator">=</span> <span class="token builtin">float</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span>'Standard deviation <span class="token keyword">for</span> the convolution <span class="token keyword">in</span> multiples of the\
 increment<span class="token punctuation">:</span> '<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Spektrum einlesen</span>
spectrum <span class="token operator">=</span> <span class="token builtin">ascii</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span>spectrum_name<span class="token punctuation">,</span> guess<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token comment">#   Convolve using astropy.convolution</span>
kernel <span class="token operator">=</span> Gaussian1DKernel<span class="token punctuation">(</span>stddev<span class="token operator">=</span>std<span class="token punctuation">)</span>
convoluted <span class="token operator">=</span> convolve<span class="token punctuation">(</span>spectrum<span class="token punctuation">[</span><span class="token string">'FLUX'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> kernel<span class="token punctuation">,</span> normalize_kernel<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
                      boundary<span class="token operator">=</span><span class="token string">'extend'</span><span class="token punctuation">)</span>

name <span class="token operator">=</span> spectrum_name<span class="token operator">+</span><span class="token string">'_convolved.dat'</span>

<span class="token comment"># Graphics</span>
fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>suptitle<span class="token punctuation">(</span><span class="token string">'Spectrum '</span><span class="token operator">+</span>spectrum_name<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>spectrum<span class="token punctuation">[</span><span class="token string">'WAVE'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> spectrum<span class="token punctuation">[</span><span class="token string">'FLUX'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'Wavelength in Angstrom'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'relative Flux'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>spectrum<span class="token punctuation">[</span><span class="token string">'WAVE'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> convoluted<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'Wavelength in Angstrom'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'relative Flux'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span>name<span class="token punctuation">)</span>
<span class="token comment"># saving graphics</span>
plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span>name<span class="token operator">+</span><span class="token string">'.png'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span>name<span class="token operator">+</span><span class="token string">'.pdf'</span><span class="token punctuation">)</span>

<span class="token comment"># Saving of convolved</span>
<span class="token builtin">ascii</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token punctuation">[</span>spectrum<span class="token punctuation">[</span><span class="token string">'WAVE'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> convoluted<span class="token punctuation">]</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> overwrite<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
            names<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'WAVE'</span><span class="token punctuation">,</span> <span class="token string">'FLUX'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token builtin">format</span><span class="token operator">=</span><span class="token string">'tab'</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/Astro/assets/img/template_convolved.667e533f.png" alt=""></p> <h3 id="_2-å¤„ç†-pollux-æ¨¡å‹å…‰è°±"><a href="#_2-å¤„ç†-pollux-æ¨¡å‹å…‰è°±" class="header-anchor">#</a> â‘¡ å¤„ç† POLLUX æ¨¡å‹å…‰è°±</h3> <blockquote><p>è¯¦æƒ…è¯·å‚è€ƒ <a href="https://lotharschanne.wordpress.com/processing-of-pollux-model-spectra/" target="_blank" rel="noopener noreferrer">Processing POLLUX model spectra<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>POLLUX æ˜¯ä¸€ä¸ªé«˜åˆ†è¾¨ç‡çš„ç†è®ºåˆæˆå…‰è°±åº“</p></blockquote> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">from</span> astropy<span class="token punctuation">.</span>convolution <span class="token keyword">import</span> Gaussian1DKernel
<span class="token keyword">from</span> astropy<span class="token punctuation">.</span>convolution <span class="token keyword">import</span> convolve
<span class="token keyword">from</span> astropy<span class="token punctuation">.</span>io <span class="token keyword">import</span> <span class="token builtin">ascii</span>

<span class="token builtin">file</span> <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">'path and name of the file: '</span><span class="token punctuation">)</span>
lambda_min <span class="token operator">=</span> <span class="token builtin">float</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">'Input of the start wavelength in the spectrum: '</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
deltalambda <span class="token operator">=</span> <span class="token builtin">float</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">'Input of the step in the spectrum: '</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
std <span class="token operator">=</span> <span class="token builtin">float</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span>'Standard deviation <span class="token keyword">for</span> the convolution <span class="token keyword">in</span> multiples of the\
 increment<span class="token punctuation">:</span> '<span class="token punctuation">)</span><span class="token punctuation">)</span>

table <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_fwf<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> names<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'WAVE'</span><span class="token punctuation">,</span> <span class="token string">'AFLUX'</span><span class="token punctuation">,</span> <span class="token string">'NFLUX'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>

wl_li <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">'Begin of Wavelength range: '</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
wl_re <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">'End of Wavelength range: '</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
ind_li <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token punctuation">(</span>wl_li<span class="token operator">-</span>lambda_min<span class="token punctuation">)</span> <span class="token operator">/</span> deltalambda<span class="token punctuation">)</span>
ind_re <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token punctuation">(</span>wl_re<span class="token operator">-</span>lambda_min<span class="token punctuation">)</span> <span class="token operator">/</span> deltalambda<span class="token punctuation">)</span>
bereich <span class="token operator">=</span> table<span class="token punctuation">[</span>ind_li<span class="token punctuation">:</span>ind_re<span class="token punctuation">]</span>

<span class="token comment">#   Convolve using astropy.convolution</span>
kernel <span class="token operator">=</span> Gaussian1DKernel<span class="token punctuation">(</span>stddev<span class="token operator">=</span>std<span class="token punctuation">)</span>
con <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>bereich<span class="token punctuation">[</span><span class="token string">'NFLUX'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
convoluted <span class="token operator">=</span> convolve<span class="token punctuation">(</span>con<span class="token punctuation">,</span> kernel<span class="token punctuation">,</span> normalize_kernel<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
                      boundary<span class="token operator">=</span><span class="token string">'extend'</span><span class="token punctuation">)</span>

<span class="token comment"># Graphics</span>
plt<span class="token punctuation">.</span>style<span class="token punctuation">.</span>use<span class="token punctuation">(</span><span class="token string">'seaborn-whitegrid'</span><span class="token punctuation">)</span>
fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>set_size_inches<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'Wavelength [Angstrom]'</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>suptitle<span class="token punctuation">(</span><span class="token string">'Spectrum '</span><span class="token operator">+</span><span class="token builtin">file</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>
ax<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>table<span class="token punctuation">[</span><span class="token string">'WAVE'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> table<span class="token punctuation">[</span><span class="token string">'NFLUX'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
ax<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>bereich<span class="token punctuation">[</span><span class="token string">'WAVE'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> bereich<span class="token punctuation">[</span><span class="token string">'NFLUX'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
ax<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>bereich<span class="token punctuation">[</span><span class="token string">'WAVE'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> convoluted<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token operator">+</span><span class="token string">'.png'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token operator">+</span><span class="token string">'.pdf'</span><span class="token punctuation">)</span>

<span class="token comment"># Save convoluted spectrum, NFLUX now as FLUX</span>
convol_file <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>bereich<span class="token punctuation">[</span><span class="token string">'WAVE'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> convoluted<span class="token punctuation">,</span>
                           columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'WAVE'</span><span class="token punctuation">,</span> <span class="token string">'NFLUX'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
name <span class="token operator">=</span> <span class="token builtin">file</span><span class="token punctuation">.</span>rstrip<span class="token punctuation">(</span><span class="token string">'.spec'</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'_convolved.dat'</span>
<span class="token builtin">ascii</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token punctuation">[</span>bereich<span class="token punctuation">[</span><span class="token string">'WAVE'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> convoluted<span class="token punctuation">]</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> overwrite<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
            names<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'WAVE'</span><span class="token punctuation">,</span> <span class="token string">'FLUX'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token builtin">format</span><span class="token operator">=</span><span class="token string">'tab'</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/Astro/assets/img/deneb_spec_convolved.55bfaec6.png" alt=""></p> <h3 id="_3-é™è‡³-lamost-å…‰è°±çš„ä½åˆ†è¾¨ç‡"><a href="#_3-é™è‡³-lamost-å…‰è°±çš„ä½åˆ†è¾¨ç‡" class="header-anchor">#</a> â‘¢ é™è‡³ LAMOST å…‰è°±çš„ä½åˆ†è¾¨ç‡</h3> <blockquote><p>å®éªŒä¸­ç”¨åˆ°çš„åˆ†è¾¨ç‡ä¸º 50,000 çš„å…‰è°± â€‹<a href="https://gitee.com/iScottMark/Astro/raw/master/docs/spectroscopy/spectra_process/ap00t5777g44377k1odfnew_50000.spec" target="_blank" rel="noopener noreferrer">ğŸ“— ä¸‹è½½é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> scipy<span class="token punctuation">.</span>signal
<span class="token keyword">from</span> scipy<span class="token punctuation">.</span>ndimage <span class="token keyword">import</span> gaussian_filter1d
<span class="token keyword">from</span> scipy <span class="token keyword">import</span> interpolate
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt


<span class="token keyword">def</span> <span class="token function">conv</span><span class="token punctuation">(</span>origin_flux<span class="token punctuation">,</span> old_resolution<span class="token punctuation">,</span> new_resolution<span class="token punctuation">,</span> step<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot; degrade spectral resolution in LAMOST scale
    :param origin_flux: the original flux of high spectral resolution
    :param old_resolution: high resolution
    :param new_resolution: low resolution
    :param step: the step of original spectra wavelength
    :return: the degraded flux of low resolution
    &quot;&quot;&quot;</span>
    <span class="token comment"># 5000 angstrom is the approximate central wavelength of LAMOST</span>
    <span class="token comment"># 2.355 is the constant of the transformation from FWHM (i.e. delta lambda) to sigma</span>
    sigma <span class="token operator">=</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">.</span> <span class="token operator">/</span> new_resolution<span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">.</span> <span class="token operator">/</span> old_resolution<span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">2.355</span> <span class="token operator">*</span> step<span class="token punctuation">)</span>
    <span class="token comment"># use gaussian kernel to degrade the spectra</span>
    degraded_flux <span class="token operator">=</span> gaussian_filter1d<span class="token punctuation">(</span>origin_flux<span class="token punctuation">,</span> sigma<span class="token punctuation">)</span>
    <span class="token keyword">return</span> degraded_flux


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    <span class="token comment"># è¯»å–åŸå§‹å…‰è°±æ–‡ä»¶</span>
    data <span class="token operator">=</span> np<span class="token punctuation">.</span>loadtxt<span class="token punctuation">(</span><span class="token string">'ap00t5777g44377k1odfnew_50000.spec'</span><span class="token punctuation">)</span>
    wave_01 <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>  <span class="token comment"># åŸå§‹æ³¢é•¿çš„æ­¥é•¿é—´éš”ä¸º 0.1 angstrom</span>
    flux_01 <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>

    <span class="token comment"># å¯¹å…‰è°±è¿›è¡Œæ’å€¼ï¼Œåˆ†åˆ«å°†æµé‡æ’å€¼åˆ°æ³¢é•¿çš„æ­¥é•¿é—´éš”ä¸º 0.01 å’Œ 0.005</span>
    <span class="token comment"># åŒæ—¶ï¼Œä¸ºäº†æ–¹ä¾¿å±•ç¤ºï¼Œåªæˆªå– [4800, 6800] è¿™ä¸€æ®µæ³¢é•¿</span>
    wave_001 <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">4800</span><span class="token punctuation">,</span> <span class="token number">6800</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span>
    flux_001 <span class="token operator">=</span> interpolate<span class="token punctuation">.</span>interp1d<span class="token punctuation">(</span>wave_01<span class="token punctuation">,</span> flux_01<span class="token punctuation">)</span><span class="token punctuation">(</span>wave_001<span class="token punctuation">)</span>
    wave_0005 <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">4800</span><span class="token punctuation">,</span> <span class="token number">6799.99</span><span class="token punctuation">,</span> <span class="token number">0.005</span><span class="token punctuation">)</span>
    flux_0005 <span class="token operator">=</span> interpolate<span class="token punctuation">.</span>interp1d<span class="token punctuation">(</span>wave_01<span class="token punctuation">,</span> flux_01<span class="token punctuation">)</span><span class="token punctuation">(</span>wave_0005<span class="token punctuation">)</span>

    <span class="token comment"># åˆ†åˆ«å¯¹æ­¥é•¿ä¸º 0.01 å’Œ 0.005 çš„æµé‡é™ä½åˆ†è¾¨ç‡</span>
    flux_001_degrade <span class="token operator">=</span> conv<span class="token punctuation">(</span>origin_flux<span class="token operator">=</span>flux_001<span class="token punctuation">,</span> old_resolution<span class="token operator">=</span><span class="token number">50000</span><span class="token punctuation">,</span>
                            new_resolution<span class="token operator">=</span><span class="token number">7500</span><span class="token punctuation">,</span> step<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">)</span>
    flux_0005_degrade <span class="token operator">=</span> conv<span class="token punctuation">(</span>origin_flux<span class="token operator">=</span>flux_0005<span class="token punctuation">,</span> old_resolution<span class="token operator">=</span><span class="token number">50000</span><span class="token punctuation">,</span>
                             new_resolution<span class="token operator">=</span><span class="token number">7500</span><span class="token punctuation">,</span> step<span class="token operator">=</span><span class="token number">0.005</span><span class="token punctuation">)</span>

    <span class="token comment"># ç”»å›¾</span>
    plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>wave_01<span class="token punctuation">,</span> flux_01<span class="token punctuation">,</span> <span class="token string">'b-'</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'step01'</span><span class="token punctuation">)</span>
    <span class="token comment"># + 40 åç§»ï¼Œå¦åˆ™æ­¥é•¿ä¸º 0.01 çš„ç»¿çº¿ä¼šè¢«æ­¥é•¿ä¸º 0.005 çš„çº¢çº¿å®Œå…¨è¦†ç›–ï¼Œçœ‹ä¸å‡ºæ¥</span>
    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>wave_001 <span class="token operator">+</span> <span class="token number">40</span><span class="token punctuation">,</span> flux_001_degrade<span class="token punctuation">,</span> <span class="token string">'g-'</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'step001'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>wave_0005<span class="token punctuation">,</span> flux_0005_degrade<span class="token punctuation">,</span> <span class="token string">'r--'</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'step0005'</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/Astro/assets/img/degrade_lamost.ba23401c.png" alt=""></p> <h3 id="_4-é™ä½ä¸ç­‰é—´éš”æ³¢é•¿æ­¥é•¿çš„å…‰è°±åˆ†è¾¨ç‡"><a href="#_4-é™ä½ä¸ç­‰é—´éš”æ³¢é•¿æ­¥é•¿çš„å…‰è°±åˆ†è¾¨ç‡" class="header-anchor">#</a> â‘£ é™ä½ä¸ç­‰é—´éš”æ³¢é•¿æ­¥é•¿çš„å…‰è°±åˆ†è¾¨ç‡</h3> <blockquote><p>è¯¦æƒ…è¯·å‚è€ƒ <a href="https://github.com/jason-neal/convolve_spectrum" target="_blank" rel="noopener noreferrer">convolve_spectra<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">æœ€åæ›´æ–°äº:</span> <span class="time">6/30/2021, 10:41:18 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/Astro/spectroscopy/spectra_process/" class="prev router-link-active">
        å…‰è°±å¤„ç†
      </a></span> <!----></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/Astro/assets/js/app.2824fc65.js" defer></script><script src="/Astro/assets/js/2.a0d0d233.js" defer></script><script src="/Astro/assets/js/3.90804e27.js" defer></script>
  </body>
</html>
